<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="Lecture2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lecture2_files/libs/quarto-html/tabby.min.js"></script>
<script src="Lecture2_files/libs/quarto-html/popper.min.js"></script>
<script src="Lecture2_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Lecture2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lecture2_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Lecture2_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.40">

  <meta name="author" content="Jamie Haddock">
  <title>Lecture 2: Algorithms, Stability, Linear algebra review</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Lecture2_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Lecture2_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Lecture2_files/libs/revealjs/dist/theme/quarto-bbe7401fe57d4b791b917637bb662036.css">
  <link rel="stylesheet" href="input/slides.css">
  <link href="Lecture2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Lecture2_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Lecture2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Lecture2_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="Lecture2_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="Lecture2_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Lecture 2: Algorithms, Stability, Linear algebra review</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Jamie Haddock 
</div>
</div>
</div>

</section>
<section>
<section id="algorithms" class="title-slide slide level1 center">
<h1>Algorithms</h1>
<p>A problem <span class="math inline">\(f(x)\)</span> can typically only be approximated in finite precision (e.g., floating-point representation). A complete set of instructions for transforming data into a result is called an <strong>algorithm</strong>. In most cases, we can represent the output from the algorithm by another function <span class="math inline">\(\tilde{f}(x)\)</span>, and for the next few lectures, we will consider the algorithm to be executed in finite precision.</p>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<p>Suppose our problem is to evaluate the value of a polynomial given a real input <span class="math inline">\(x\)</span>, <span class="math display">\[f(x) = 5x^3 + 4x^2 + 3x + 2.\]</span></p>
<p>Here are two possible algorithms for evaluating this polynomial:</p>
<ul>
<li class="fragment">Evalate <span class="math inline">\(x^2 = x\times x\)</span> and <span class="math inline">\(x^3 = x \times x^3\)</span> with two multiplications, then calculate <span class="math inline">\(5x^3, 4x^2,\)</span> and <span class="math inline">\(3x\)</span> with three additional multiplications, and finally evaluate <span class="math inline">\(5x^3 + 4x^2 + 3x + 2\)</span> with three additions, for a total of eight arithmetic operations.</li>
<li class="fragment">Organize the polynomial as <span class="math inline">\(2 + x(3 + x(4 + 5x))\)</span> which requires three multiplications and three additions, for a total of six arithmetic operations.</li>
</ul>
<div class="fragment">
<p>This savings may seem small, but saving 25% of the total operations can be <em>huge</em> when the numbe of operations is in the millions or billions!</p>
</div>
</section>
<section id="algorithms-as-code" class="slide level2">
<h2>Algorithms as Code</h2>
<p>The technique we just saw in the previous example is known as Horner’s rule or algorithm We have that <span class="math inline">\(p(x) = c_1 + c_2x + c_3x^2 + \cdots + c_nx^{n-1} = c_1 + x(c_2 + \cdots + x(c_{n-2} + x(c_{n-1} + c_nx))).\)</span></p>
<!--
[verbose test]{.content-hidden when-format="revealjs" when-format="pptx"}

::: {.callout-caution icon=false}
## Exercise: 

:::

<details><summary>Answer:</summary> </details>


::: {.callout-note icon=false}
## Definition: 
 
:::


::: {.callout-tip icon=false}
## Note: 
 
:::
-->
<div id="4ec0cbe0" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href=""></a><span class="st">"""</span></span>
<span id="cb1-2"><a href=""></a><span class="st">    horner(c,x)</span></span>
<span id="cb1-3"><a href=""></a></span>
<span id="cb1-4"><a href=""></a><span class="st">Evaluate a polynomial whose coefficients are given in ascending (according to</span></span>
<span id="cb1-5"><a href=""></a><span class="st">associated monomial degree) order in 'c', at the point 'x' using Horner's</span></span>
<span id="cb1-6"><a href=""></a><span class="st">algorithm.</span></span>
<span id="cb1-7"><a href=""></a><span class="st">"""</span></span>
<span id="cb1-8"><a href=""></a></span>
<span id="cb1-9"><a href=""></a><span class="kw">function</span> <span class="fu">horner</span>(c,x)</span>
<span id="cb1-10"><a href=""></a>    n <span class="op">=</span> <span class="fu">length</span>(c)</span>
<span id="cb1-11"><a href=""></a>    y <span class="op">=</span> c[n]</span>
<span id="cb1-12"><a href=""></a>    <span class="cf">for</span> k <span class="kw">in</span> n<span class="op">-</span><span class="fl">1</span><span class="op">:-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span></span>
<span id="cb1-13"><a href=""></a>        y <span class="op">=</span> x<span class="op">*</span>y <span class="op">+</span> c[k]</span>
<span id="cb1-14"><a href=""></a>    <span class="cf">end</span></span>
<span id="cb1-15"><a href=""></a>    <span class="cf">return</span> y</span>
<span id="cb1-16"><a href=""></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>horner (generic function with 1 method)</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Let’s use this function to evaluate the value a given polynomial!</p>
<div id="a0abf81b" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href=""></a>c <span class="op">=</span> [<span class="op">-</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="op">-</span><span class="fl">3</span>,<span class="fl">1</span>]</span>
<span id="cb3-2"><a href=""></a></span>
<span id="cb3-3"><a href=""></a><span class="fu">horner</span>(c,<span class="fl">1.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>0.21600000000000041</code></pre>
</div>
</div>
</section></section>
<section>
<section id="stability" class="title-slide slide level1 center">
<h1>Stability</h1>
<p>If we solve a problem <span class="math inline">\(f\)</span> using a computer algorithm and we see a large error in the result, we might suspect that the problem has poor conditioning. However, it could also be that the <em>algorithm</em> introduced additional error. When error in the output of an algorithm exceeds what the problem conditioning explains, we say that the algorithm is <strong>unstable</strong>.</p>
</section>
<section id="case-study-stability" class="slide level2">
<h2>Case Study: Stability</h2>
<p>We’re returning to the problem of calculating roots of a quadratic polynomial; that is finding values <span class="math inline">\(t\)</span> such that <span class="math inline">\(at^2 + bt + c = 0\)</span>. In Lecture 1, we showed that this problem is ill-conditioned if and only if the roots are close together relative to their size.</p>
<div class="fragment">
<p>Thus, find the roots of the polynomial <span class="math inline">\(p(x) = (x- 10^6)(x - 10^{-6}) = x^2 - (10^6 + 10^{-6})x + 1\)</span> is a well-conditioned problem. As we saw previously, the quadratic formula is an algorithm for this problem.</p>
</div>
<div class="fragment">
<div id="bdd123ea" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href=""></a>a <span class="op">=</span> <span class="fl">1</span>; b <span class="op">=</span> <span class="fu">-</span>(<span class="fl">1e6</span><span class="op">+</span><span class="fl">1e-6</span>); c <span class="op">=</span> <span class="fl">1</span>;</span>
<span id="cb5-2"><a href=""></a><span class="pp">@show</span> x₁ <span class="op">=</span> (<span class="op">-</span>b <span class="op">+</span> <span class="fu">sqrt</span>(b<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">4</span>a<span class="op">*</span>c)) <span class="op">/</span> <span class="fl">2</span>a;</span>
<span id="cb5-3"><a href=""></a><span class="pp">@show</span> x₂ <span class="op">=</span> (<span class="op">-</span>b <span class="op">-</span> <span class="fu">sqrt</span>(b<span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">4</span>a<span class="op">*</span>c)) <span class="op">/</span> <span class="fl">2</span>a;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>x₁ = (-b + sqrt(b ^ 2 - (4a) * c)) / (2a) = 1.0e6
x₂ = (-b - sqrt(b ^ 2 - (4a) * c)) / (2a) = 1.00000761449337e-6</code></pre>
</div>
</div>
</div>
</section>
<section class="slide level2">

<p>The larger root has no error, but now we measure the relative error in the smaller root!</p>
<div id="61b4bb15" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href=""></a>error <span class="op">=</span> <span class="fu">abs</span>(<span class="fl">1e-6</span> <span class="op">-</span> x₂) <span class="op">/</span> <span class="fl">1e-6</span></span>
<span id="cb7-2"><a href=""></a><span class="pp">@show</span> accurate_digits <span class="op">=</span> <span class="fu">-log10</span>(error);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>accurate_digits = -(log10(error)) = 5.118358987126217</code></pre>
</div>
</div>
<div id="3354746a" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href=""></a><span class="pp">@show</span> u₁ <span class="op">=</span> b<span class="op">^</span><span class="fl">2</span>;</span>
<span id="cb9-2"><a href=""></a><span class="pp">@show</span> u₂ <span class="op">=</span> u₁ <span class="op">-</span> <span class="fl">4</span>;</span>
<span id="cb9-3"><a href=""></a><span class="pp">@show</span> u₃ <span class="op">=</span> <span class="fu">sqrt</span>(u₂);</span>
<span id="cb9-4"><a href=""></a><span class="pp">@show</span> u₄ <span class="op">=</span> <span class="op">-</span>u₃ <span class="op">-</span> b;</span>
<span id="cb9-5"><a href=""></a><span class="pp">@show</span> u₅ <span class="op">=</span> u₄<span class="op">/</span><span class="fl">2</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>u₁ = b ^ 2 = 1.000000000002e12
u₂ = u₁ - 4 = 9.99999999998e11
u₃ = sqrt(u₂) = 999999.999999
u₄ = -u₃ - b = 2.00001522898674e-6
u₅ = u₄ / 2 = 1.00000761449337e-6</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Since <span class="math inline">\(a = c = 1\)</span>, we’ll assume these are represented exactly, and consider only the condition number with respect to <span class="math inline">\(b\)</span>. We can see where the instability in the smaller root calculation came from by considering the condition number of each of the sub-problems encountered.</p>
<div class="fragment">
<table class="caption-top">
<colgroup>
<col style="width: 52%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th>Problem <span class="math inline">\(f\)</span></th>
<th><span class="math inline">\(\kappa_f\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(u_1 = f_1(b) = b^2\)</span></td>
<td><span class="math inline">\(\kappa_{f_1}(b) = 2\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(u_2 = f_2(u_1) = u_1 - 4\)</span></td>
<td><span class="math inline">\(\kappa_{f_2}(u_1) \approx 1\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(u_3 = f_3(u_2) = \sqrt{u_2}\)</span></td>
<td><span class="math inline">\(\kappa_{f_3}(u_2) = 1/2\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(u_4 = f_4(u_3) = -(u_3 + b)\)</span></td>
<td><span class="math inline">\(\kappa_{f_4}(u_3) \approx 5 \times 10^{11}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(u_5 = f_5(u_4) = u_4/2\)</span></td>
<td><span class="math inline">\(\kappa_{f_5}(u_4) = 1\)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="fragment">
<p>We expect to lose 11 digits of accuracy in the fourth step of this algorithm. Here the issue is the subtractive cancellation between <span class="math inline">\(\sqrt{b^2 - 4ac}\)</span> and <span class="math inline">\(b\)</span>!</p>
</div>
<div class="fragment">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Note:</strong></p>
</div>
<div class="callout-content">
<p>The quadratic formula is <em>unstable</em> for computing polynomial roots in finite precision! The problem of calculating the roots is not unstable (as we saw previously), it is simply that the specific computational steps we took to calculate this root is unstable as a subroutine is ill-conditioned.</p>
</div>
</div>
</div>
</div>
</section>
<section class="slide level2">

<p>We can compute this root with no error using a different algorithm!</p>
<div id="bf075588" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href=""></a><span class="pp">@show</span> x₂ <span class="op">=</span> c <span class="op">/</span> (a <span class="op">*</span> x₁);</span>
<span id="cb11-2"><a href=""></a></span>
<span id="cb11-3"><a href=""></a><span class="fu">abs</span>(x₂ <span class="op">-</span> <span class="fl">1e-6</span>) <span class="op">/</span> <span class="fl">1e-6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>x₂ = c / (a * x₁) = 1.0e-6</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>0.0</code></pre>
</div>
</div>
<p>These two algorithms are equivalent when using real numbers and exact arithmetic, but the outputs they calculate in practice are perturbed by finite precision representation in each step and depend upon the specific order of operation.</p>
<div class="fragment">
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Fact:</strong></p>
</div>
<div class="callout-content">
<p>The sensitivity of a problem <span class="math inline">\(f(x)\)</span> is governed only by <span class="math inline">\(\kappa_f\)</span>, but the sensitivity of an algorithm depends on the condition numbers of all its individual steps.</p>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>This may seem scary and complicated, but most simple operations are well-conditioned most of the time! Exceptions are usually due to <span class="math inline">\(|f(x)|\)</span> being much smaller than <span class="math inline">\(|x|\)</span>, and the most common culprit (by far!) is subtractive cancellation.</p>
</div>
</section>
<section id="backward-error" class="slide level2">
<h2>Backward error</h2>
<p>If a problem <span class="math inline">\(f(x)\)</span> has poor conditioning, event just the act of rounding the data to floating-point representation may introduce large errors in the result. It’s not reasonable to expect that algorithms <span class="math inline">\(\tilde{f}\)</span> will have small error in the sense that <span class="math inline">\(\tilde{f}(x) \approx f(x)\)</span>.</p>
<div class="fragment">
<p>Numerical analysts instead prefer to characterize the error in a different way – instead of asking “Did you get nearly the right answer?”, we ask “Did you answer nearly the right question?”</p>
</div>
<div class="fragment">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Definition: Backward error</strong></p>
</div>
<div class="callout-content">
<p>Let <span class="math inline">\(\tilde{f}\)</span> be an algorithm for the problem <span class="math inline">\(f\)</span>. Let <span class="math inline">\(y = f(x)\)</span> be an exact result and <span class="math inline">\(\tilde{y} = \tilde{f}(x)\)</span> be its approximation by the algorithm. If there is a value <span class="math inline">\(\tilde{x}\)</span> such that <span class="math inline">\(f(\tilde{x}) = \tilde{y}\)</span>, then the <strong>relative backward error</strong> in <span class="math inline">\(\tilde{y}\)</span> is <span class="math display">\[\frac{|\tilde{x} - x|}{|x|}.\]</span> The <strong>absolute backward error</strong> is <span class="math inline">\(|\tilde{x} - x|\)</span>.</p>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Backward error analysis causes us to ask “What is the problem our algorithm actually solved?” and to measure the distance between the ideal data and this alternative input to <span class="math inline">\(f\)</span>.</p>
</div>
</section>
<section class="slide level2">

<p><img data-src="figs/backward_error.png" height="200"></p>
<div id="38b7acef" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href=""></a><span class="im">using</span> <span class="bu">Pkg</span></span>
<span id="cb14-2"><a href=""></a><span class="bu">Pkg</span>.<span class="fu">add</span>(<span class="st">"Polynomials"</span>)</span>
<span id="cb14-3"><a href=""></a><span class="im">using</span> <span class="bu">Polynomials</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can build the polynomial <span class="math inline">\(p\)</span> from its roots, <span class="math inline">\(-2, -1, 1, 1, 3, 6\)</span>. We do this so we know the exact roots of the polynomial.</p>
<div id="3b1482b8" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href=""></a>r <span class="op">=</span> [<span class="op">-</span><span class="fl">2.0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">6</span>]</span>
<span id="cb15-2"><a href=""></a>p <span class="op">=</span> <span class="fu">fromroots</span>(r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
36.0 - 36.0∙x - 43.0∙x<sup>2</sup> + 44.0∙x<sup>3</sup> + 6.0∙x<sup>4</sup> - 8.0∙x<sup>5</sup> + 1.0∙x<sup>6</sup>
</div>
</div>
</section>
<section class="slide level2">

<p>Now, we compute the roots of <span class="math inline">\(p\)</span> using an algorithm and see how much error has been introduced into each root.</p>
<div id="43764acc" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href=""></a>r̃ <span class="op">=</span> <span class="fu">sort</span>(<span class="fu">roots</span>(p))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>6-element Vector{Float64}:
 -1.9999999999999993
 -1.0000000000000002
  0.9999999876576552
  1.0000000123423434
  3.0000000000000036
  5.999999999999993</code></pre>
</div>
</div>
<div id="8011483f" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href=""></a><span class="fu">println</span>(<span class="st">"Root errors:"</span>)</span>
<span id="cb18-2"><a href=""></a>@. <span class="fu">abs</span>(r <span class="op">-</span> r̃) <span class="op">/</span> r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Root errors:</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>6-element Vector{Float64}:
 -3.3306690738754696e-16
 -2.220446049250313e-16
  1.2342344812843464e-8
  1.2342343369553532e-8
  1.1842378929335002e-15
  1.1842378929335002e-15</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Next, we build a polynomial <span class="math inline">\(\tilde{p}\)</span> from these approximate roots and check how far these output coefficients have deviated from the true coefficients.</p>
<div id="1b067b2f" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href=""></a>p̃ <span class="op">=</span> <span class="fu">fromroots</span>(r̃)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
35.999999999999936 - 35.99999999999999∙x - 42.99999999999993∙x<sup>2</sup> + 43.99999999999997∙x<sup>3</sup> + 5.999999999999998∙x<sup>4</sup> - 7.999999999999996∙x<sup>5</sup> + 1.0∙x<sup>6</sup>
</div>
</div>
<div id="91538c3e" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href=""></a>c, c̃ <span class="op">=</span> <span class="fu">coeffs</span>(p), <span class="fu">coeffs</span>(p̃)</span>
<span id="cb22-2"><a href=""></a><span class="fu">println</span>(<span class="st">"Coefficients errors:"</span>)</span>
<span id="cb22-3"><a href=""></a>@. <span class="fu">abs</span>(c <span class="op">-</span> c̃) <span class="op">/</span> c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients errors:</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>7-element Vector{Float64}:
  1.7763568394002505e-15
 -1.9737298215558337e-16
 -1.6524249668839539e-15
  6.459479416000911e-16
  2.9605947323337506e-16
 -5.551115123125783e-16
  0.0</code></pre>
</div>
</div>
<div class="fragment">
<p>Even though some computed roots were relatively far from the exact values, they are roots of a polynomial that is nearby to the ideal polynomial! In other words, we solved a problem nearby to the original problem, even if the results were quite far apart.</p>
</div>
</section>
<section class="slide level2">

<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Fact:</strong></p>
</div>
<div class="callout-content">
<p>For a poorly conditioned problem, we can really only hope for small backward error. Informally, if an algorithm always produces small backward error then it is stable. The converse is not ture – some stable algorithms may produce a large backward error!</p>
</div>
</div>
</div>
<div class="fragment">
<p>As an example, the algorithm <span class="math inline">\(f(x) = x + 1\)</span> is stable, but not backward stable. If <span class="math inline">\(|x| &lt; \epsilon_{\text{mach}}/2,\)</span> then the computed result is <span class="math inline">\(\tilde{f}(x) = 1\)</span> since there are no floating points between <span class="math inline">\(1\)</span> and <span class="math inline">\(1 + \epsilon_{\text{mach}}\)</span>.</p>
</div>
<div class="fragment">
<p>Hence, the only choice for a real <span class="math inline">\(\tilde{x}\)</span> so that <span class="math inline">\(f(\tilde{x}) = \tilde{f}(x) = 1\)</span> is <span class="math inline">\(\tilde{x} = 0\)</span>. Then <span class="math inline">\(|\tilde{x} - x|/|x| = 1\)</span> – 100% backward error!</p>
</div>
</section></section>
<section>
<section id="linear-algebra-review" class="title-slide slide level1 center">
<h1>Linear Algebra Review</h1>

</section>
<section id="matrix-multiplication" class="slide level2">
<h2>Matrix Multiplication</h2>
<p>There are two important (and equivalent) views of matrix multiplication. Let <span class="math inline">\(\mathbf{A} \in \mathbb{R}^{m \times n}, \mathbf{B} \in \mathbb{R}^{n \times p}\)</span> and <span class="math inline">\(\mathbf{C} = \mathbf{A}\mathbf{B} \in \mathbb{R}^{m \times p}\)</span>.</p>
<div class="fragment">
<p>The entries of <span class="math inline">\(\mathbf{C} = \mathbf{A}\mathbf{B}\)</span> may be calculated by the <em>inner product</em>, <span class="math display">\[\mathbf{C}_{ij} = \sum_{k = 1}^n \mathbf{A}_{ik}\mathbf{B}_{kj}.\]</span></p>
</div>
<div class="fragment">
<p>The alternative view of matrix multiplication is as a sum of rank-one matrices formed as <em>outer products</em> of corresponding columns of <span class="math inline">\(\mathbf{A}\)</span> and rows of <span class="math inline">\(\mathbf{B}\)</span>, <span class="math display">\[\mathbf{C} = \sum_{k = 1}^n \mathbf{A}_{:k} \mathbf{B}_{k:}.\]</span></p>
</div>
</section>
<section id="matrix-vector-multiplication" class="slide level2">
<h2>Matrix-vector multiplication</h2>
<p>Using the previous interpretations of matrix multiplications, we can better understand the special case of matrix-vector multiplication. Consider computing <span class="math inline">\(\mathbf{A}\mathbf{v}\)</span> for matrix <span class="math inline">\(\mathbf{A} \in \mathbb{R}^{m times n}\)</span> and vector <span class="math inline">\(\mathbf{v} \in \mathbb{R}^n\)</span>.</p>
<div class="fragment">
<p>We have that <span class="math display">\[\mathbf{A}\mathbf{v} = v_1 \mathbf{a}_1 + \cdots + v_n \mathbf{a}_n\]</span> where <span class="math inline">\(\mathbf{a}_i\)</span> is the <span class="math inline">\(i\)</span>th columns of <span class="math inline">\(\mathbf{A}\)</span>.</p>
</div>
<div class="fragment">
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Fact:</strong></p>
</div>
<div class="callout-content">
<p>Multiplying a matrix on the right by a column vector, <span class="math inline">\(\mathbf{A}\mathbf{v}\)</span>, produces a linear combination of the columns of the matrix.</p>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>We may transpose the matrix-vector product to get:</p>
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Fact:</strong></p>
</div>
<div class="callout-content">
<p>Multiplying a matrix on the left by a row vector produces a linear combination of the rows of the matrix.</p>
</div>
</div>
</div>
</div>
</section>
<section class="slide level2">

<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Fact:</strong></p>
</div>
<div class="callout-content">
<p>A matrix-matrix product is a horizontal concatenation of matrix-vector products involving the columns of the right-hand matrix. Equivalently, a matrix-matrix product is also a vertical concatenation of vector-matrix products involving the rows of the left-hand matrix.</p>
</div>
</div>
</div>
<div class="fragment">
<p>Recall the following important theorem:</p>
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Theorem:</strong></p>
</div>
<div class="callout-content">
<p>The following statements are equivalent: 1. <span class="math inline">\(\mathbf{A}\)</span> is nonsingular 2. <span class="math inline">\((\mathbf{A}^{-1})^{-1} = \mathbf{A}\)</span> 3. <span class="math inline">\(\mathbf{A}\mathbf{x} = \mathbf{0}\)</span> implies that <span class="math inline">\(\mathbf{x} = \mathbf{0}\)</span> 4. <span class="math inline">\(\mathbf{A}\mathbf{x} = \mathbf{b}\)</span> has a unique solution, <span class="math inline">\(\mathbf{x} = \mathbf{A}^{-1} \mathbf{b}\)</span>, for any <span class="math inline">\(n\)</span>-vector <span class="math inline">\(\mathbf{b}\)</span></p>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Theorem: Spectral Theorem</strong></p>
</div>
<div class="callout-content">
<p>Let <span class="math inline">\(\mathbf{A}\)</span> be a real, <span class="math inline">\(n \times n\)</span> matrix. Then <span class="math inline">\(\mathbf{A}\)</span> is symmetric if and only if <span class="math inline">\(\mathbf{A}\)</span> is orthogonally diagonalizable.</p>
</div>
</div>
</div>
<p>Recall that this means <span class="math inline">\(\mathbf{A} = \mathbf{Q}^\top \mathbf{D} \mathbf{Q}\)</span>.</p>
</div>
</section>
<section class="slide level2">


<img data-src="figs/four_subspaces.png" class="r-stretch"></section>
<section class="slide level2">



<img data-src="figs/fundamental_theorem.png" class="r-stretch"></section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="figs/hmc.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Lecture2_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Lecture2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Lecture2_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Lecture2_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Lecture2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Lecture2_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="Lecture2_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Lecture2_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Lecture2_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Lecture2_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Lecture2_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":false},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>